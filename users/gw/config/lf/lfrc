# gw's LF CONFIGURATION
# ---------------------

# Shell Configuration
# -------------------
set shell      bash      # shell to use
set shellopts  '-eu'     # shell parameters
set hidden     on        # show hidden files
set wrapscroll on        # infinite scrolling
set info       size:time # enables all info on status

# Custom Commands
# ---------------
# custom 'open' command that runs when the file is not a directory,
# uses a different opener depending on the mimetype. ORDER MATTERS.
cmd open &{{
    case $(file --mime-type -Lb $f) in
        */gif)   mpv $fx     ;;
        */pdf)   zathura $fx ;;
        audio/*) mpv $fx     ;;
        video/*) mpv $fx     ;;
        image/*) feh --zoom fill --scale-down -g 1066x600 $fx ;;
        # default case, when a file matches none of the aforementioned mimetypes.
        *) for f in $fx; do $OPENER $f > /dev/null 2> /dev/null & done;;
    esac
}}

# extract the current file with the right command
cmd extract ${{
    set -f
    case $f in
        *.tar.bz|*.tar.bz2|*.tbz|*.tbz2) tar xjvf $f;;
        *.tar.gz|*.tgz) tar xzvf $f;;
        *.tar.xz|*.txz) tar xJvf $f;;
        *.zip) unzip $f;;
        *.rar) unrar x $f;;
        *.7z) 7z x $f;;
    esac
}}

# copy filepath to clipboard
cmd yank-path $printf '%s' "$fx" | xclip -i -selection clipboard

# print filepath to window title
cmd on-cd &{{
    # To make sure our escape sequence still reaches stdout we pipe it to /dev/tty.
    printf "\033]0; lf $(pwd | sed "s|$HOME|~|")\007" > /dev/tty
}}

# Startup Commands
# ----------------
# filepath as title.
on-cd 
# print a warning if the current instance is already within another.
%[ $LF_LEVEL -eq 1 ] || echo "Warning: You're in a nested lf instance!"

# Custom Keybinds
# ---------------
map S shell              # run shell code
map D delete             # delete a file
map a push %mkdir<space> # mkdir bind
map Y yank-path          # copy filepath
